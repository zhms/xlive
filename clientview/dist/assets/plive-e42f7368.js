import{ag as M,r as s,c as o,ah as O,b as U,a as C,K as H,X as W,o as u,e as h,f as t,al as y,i as e,g as _,ai as $,aj as g,ak as E,j as B,ao as D,an as J,ap as L,p as K,l as X}from"./index-43cd4b4c.js";import{U as q,N as A,C as G}from"./user-f4b56e6d.js";import{_ as Q}from"./plugin-vueexport-helper-ee25f61a.js";const R=l=>(K("data-v-3cd2821b"),l=l(),X(),l),Y={class:"live"},Z={class:"user-box"},ee=R(()=>t("div",{class:"logo"},[t("img",{src:"https://static.lotterybox.com/game/live/logo111.jpg"})],-1)),te={class:"user-head flex flex-center"},ae={class:"player"},se={class:"teacher-info flex"},oe=["id","width","height","poster"],le={class:"course"},ie={class:"chat-box"},ne={__name:"plive",setup(l){M.parse(location.search.slice(1));const m=s(["https://static.lotterybox.com/game/live/2023-12-31 20.21.45.jpg","https://static.lotterybox.com/game/live/2023-12-31 20.21.53.jpg","https://static.lotterybox.com/game/live/2023-12-31 20.21.57.jpg","https://static.lotterybox.com/game/live/2023-12-31 20.22.02.jpg"]),i=s(0),N=o(()=>m.value[i.value]);O(()=>{i.value++,i.value>=m.value.length&&(i.value=0)},3e3);const P=JSON.parse(U("user").value),T=o(()=>P.is_visitor==1),a=o(()=>B.value-400-300-20),n=o(()=>D.value*.7-40),f=s("e"+ +new Date),x=s(!1);let c;const d=s(""),V=o(()=>({type:"video/x-flv",src:d.value,isLive:!0})),{data:v}=C("/api/v1/app/get_live_info",{afterFetch:async r=>{d.value=r.data.data.live_url}}).get();function b(){if(d.value==""){showToast("The live is not ready yet, please try again later");return}c.setDataSource(V.value)}function z(r){c=window.neplayer(f.value,{controls:!0,autoplay:!0,loop:!1,errMsg7:"Live is over",streamTimeoutTime:30*1e3,techOrder:["html5","flvjs"],bigPlayButton:!1,decoderPath:"https://yx-web-nosdn.netease.im/sdk-release/webplayer/",canvasId:"canvas",enableStashBuffer:!0},()=>{}),c.on("play",()=>{x.value=!0})}H(B,()=>{c.resize(a.value,n.value)});const{data:F}=C("/api/v1/app/get_online_info").get();return W(()=>{z()}),(r,p)=>{var w,k,j,I;return u(),h("div",Y,[t("div",Z,[ee,t("div",te,[t("div",null,"Online("+y(((w=e(F))==null?void 0:w.data.online_count)||0)+")",1)]),_(q)]),t("div",ae,[x.value?E("",!0):(u(),$(e(J),{key:0,class:"play-icon",name:"play-circle-o",onClick:b,size:"100",style:g({left:(e(a)-100)/2+"px",top:(e(n)-60)/2+"px"})},null,8,["style"])),t("div",se,[t("div",null,y((k=e(v))==null?void 0:k.data.name)+" | Current Lecturer: "+y((j=e(v))==null?void 0:j.data.account),1),e(T)?(u(),h("div",{key:0,class:"logout",onClick:p[0]||(p[0]=S=>r.$router.push("/"))},"Login")):(u(),h("div",{key:1,class:"logout",onClick:p[1]||(p[1]=(...S)=>e(L)&&e(L)(...S))},"Logout"))]),t("canvas",{id:"canvas",style:g({width:e(a)+"px",height:e(n)+"px"})},null,4),t("video",{class:"video-js",id:f.value,"x-webkit-airplay":"allow","webkit-playsinline":"",playsinline:"",preload:"auto",width:e(a),height:e(n),onClick:b,poster:e(N)},null,8,oe),t("div",le,[t("img",{src:"https://static.lotterybox.com/game/live/2023-12-30 10.54.47.jpg",style:g({width:e(a)+"px",height:e(D)*.3+"px"})},null,4)])]),t("div",ie,[_(e(A),{text:(I=e(v))==null?void 0:I.data.title,"left-icon":"volume-o"},null,8,["text"]),_(G)])])}}},ue=Q(ne,[["__scopeId","data-v-3cd2821b"]]);export{ue as default};
